<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speech Recording Example</title>
</head>
<body>
    <h1>Nagrywanie mowy i konwersja na tekst</h1>
    <button id="start-record-btn">Rozpocznij nagrywanie</button>
    <button id="stop-record-btn" disabled>Zatrzymaj nagrywanie</button>
    <p id="recording-status"></p>
    <h2>Rozpoznany tekst:</h2>
    <p id="recognized-text"></p>
    <script>
        const startRecordBtn = document.getElementById('start-record-btn');
        const stopRecordBtn = document.getElementById('stop-record-btn');
        const recordingStatus = document.getElementById('recording-status');
        const recognizedText = document.getElementById('recognized-text');

        // Sprawdzenie dostępności Web Speech API
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (!SpeechRecognition) {
            alert('Web Speech API nie jest wspierane w tej przeglądarce.');
        } else {
            const recognition = new SpeechRecognition();
            recognition.continuous = true; // Umożliwia ciągłe rozpoznawanie
            recognition.interimResults = true; // Umożliwia zwracanie wyników pośrednich

            recognition.onstart = function() {
                recordingStatus.textContent = 'Nagrywanie...';
            };

            recognition.onresult = function(event) {
                let interimTranscript = '';
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    const transcript = event.results[i][0].transcript;
                    if (event.results[i].isFinal) {
                        recognizedText.textContent += transcript + ' ';
                    } else {
                        interimTranscript += transcript;
                    }
                }
                recordingStatus.textContent = 'Nagrywanie... (tymczasowy tekst: ' + interimTranscript + ')';
            };

            recognition.onerror = function(event) {
                recordingStatus.textContent = 'Błąd w rozpoznawaniu mowy: ' + event.error;
            };

            recognition.onend = function() {
                recordingStatus.textContent = 'Nagrywanie zakończone.';
            };

            startRecordBtn.onclick = function() {
                recognition.start();
                startRecordBtn.disabled = true;
                stopRecordBtn.disabled = false;
            };

            stopRecordBtn.onclick = function() {
                recognition.stop();
                startRecordBtn.disabled = false;
                stopRecordBtn.disabled = true;
            };
        }
    </script>
</body>
</html>
